services:
  datn-fe-app:
    build:
      context: .
      dockerfile: Dockerfile
      target: app-production
      args:
        - VITE_API_URL=${VITE_API_URL}
        - VITE_PRESENTATION_URL=${VITE_PRESENTATION_URL}
        - VITE_FIREBASE_API_KEY=${VITE_FIREBASE_API_KEY}
        - VITE_FIREBASE_AUTH_DOMAIN=${VITE_FIREBASE_AUTH_DOMAIN}
        - VITE_FIREBASE_PROJECT_ID=${VITE_FIREBASE_PROJECT_ID}
        - VITE_FIREBASE_STORAGE_BUCKET=${VITE_FIREBASE_STORAGE_BUCKET}
        - VITE_FIREBASE_MESSAGING_SENDER_ID=${VITE_FIREBASE_MESSAGING_SENDER_ID}
        - VITE_FIREBASE_APP_ID=${VITE_FIREBASE_APP_ID}
        - VITE_FIREBASE_VAPID_KEY=${VITE_FIREBASE_VAPID_KEY}
        - NODE_ENV=production
    image: ghcr.io/tien4112004/datn-fe:app-latest
    container_name: frontend-app-aiprimary
    restart: unless-stopped
    deploy:
      resources:
        limits:
          memory: 512M
    ports:
      - '5173:5173'
    networks:
      - network-aiprimary

  datn-fe-presentation:
    build:
      context: .
      dockerfile: Dockerfile
      target: presentation-production
      args:
        - VITE_API_URL=${VITE_API_URL}
        - VITE_PRESENTATION_URL=${VITE_PRESENTATION_URL}
        - VITE_FIREBASE_API_KEY=${VITE_FIREBASE_API_KEY}
        - VITE_FIREBASE_AUTH_DOMAIN=${VITE_FIREBASE_AUTH_DOMAIN}
        - VITE_FIREBASE_PROJECT_ID=${VITE_FIREBASE_PROJECT_ID}
        - VITE_FIREBASE_STORAGE_BUCKET=${VITE_FIREBASE_STORAGE_BUCKET}
        - VITE_FIREBASE_MESSAGING_SENDER_ID=${VITE_FIREBASE_MESSAGING_SENDER_ID}
        - VITE_FIREBASE_APP_ID=${VITE_FIREBASE_APP_ID}
        - VITE_FIREBASE_VAPID_KEY=${VITE_FIREBASE_VAPID_KEY}
        - NODE_ENV=production
    image: ghcr.io/tien4112004/datn-fe:presentation-latest
    container_name: frontend-presentation-aiprimary
    restart: unless-stopped
    deploy:
      resources:
        limits:
          memory: 512M
    ports:
      - '5174:5174'
    networks:
      - network-aiprimary

  datn-fe-admin:
    build:
      context: .
      dockerfile: Dockerfile
      target: admin-production
      args:
        - VITE_API_URL=${VITE_API_URL}
        - VITE_PRESENTATION_URL=${VITE_PRESENTATION_URL}
        - VITE_FIREBASE_API_KEY=${VITE_FIREBASE_API_KEY}
        - VITE_FIREBASE_AUTH_DOMAIN=${VITE_FIREBASE_AUTH_DOMAIN}
        - VITE_FIREBASE_PROJECT_ID=${VITE_FIREBASE_PROJECT_ID}
        - VITE_FIREBASE_STORAGE_BUCKET=${VITE_FIREBASE_STORAGE_BUCKET}
        - VITE_FIREBASE_MESSAGING_SENDER_ID=${VITE_FIREBASE_MESSAGING_SENDER_ID}
        - VITE_FIREBASE_APP_ID=${VITE_FIREBASE_APP_ID}
        - VITE_FIREBASE_VAPID_KEY=${VITE_FIREBASE_VAPID_KEY}
        - NODE_ENV=production
    image: ghcr.io/tien4112004/datn-fe:admin-latest
    container_name: frontend-admin-aiprimary
    restart: unless-stopped
    deploy:
      resources:
        limits:
          memory: 512M
    ports:
      - '5175:5175'
    networks:
      - network-aiprimary

networks:
  network-aiprimary:
    name: network-aiprimary
